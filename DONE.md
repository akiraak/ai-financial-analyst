# DONE

## 完了タスク
- [x] リポジトリ作成（Initial commit）
- [x] CLAUDE.md / TODO.md / DONE.md を作成
- [x] プロジェクトの基本構成を決定（companies/nvidia、Node.js + xlsx）
- [x] 開発環境のセットアップ（package.json、xlsxパッケージ導入）
- [x] 財務データの取得方法を決定（エクセル + xlsxパッケージ）
- [x] エクセルの業績データとNVIDIA公式IRの実績値を突合（44件中42件一致、2件軽微な差異）
- [x] NVIDIA決算資料のダウンロード（FY2022〜FY2026 Q3、10-K/10-Q 19件 + プレスリリース 19件 = 全38ファイル）
- [x] 決算資料から業績データxlsxを生成するワークフローを作成
  - extract-financials.js: press-release.html からP/Lデータ抽出（19四半期、FY2022 Q1〜FY2026 Q3）
  - fetch-stock-prices.js: Yahoo Finance APIから四半期末株価取得
  - generate-xlsx.js: template.xlsxベースでNVDA-Financials.xlsx生成
  - 既存xlsxとの突合: 売上高・粗利・R&D・SGA・営業利益・純利益は100%一致
- [x] テンプレート・スクリプトの整備
  - template.xlsxから年度・Qラベル・設定パラメータを削除（スクリプトで動的設定）
  - 不要行を削除（ROE・計算PER・時価総額・設定パラメータ）
  - カテゴリ別色分けデザイン（売上:緑、利益:青、費用:橙、株式:紫）
- [x] FY2026 Q4 Outlookデータの反映（ガイダンスベースの予想値）
- [x] xlsx数値検証ワークフローを作成・実行（全437項目一致）
- [x] データ分析・可視化の要件定義（workflows/analyze-and-visualize.md）
  - グラフ4種類: P/L推移、利益率推移、株価&PER複合、費用構造
  - 技術スタック: GitHub Pages + Chart.js（静的HTML、ビルド不要）
  - 複数企業対応のディレクトリ構成を設計
- [x] GitHub PagesのPages設定を有効化（Settings → Pages → main / docs）
- [x] GitHub Pages ダッシュボードの実装（ステップ1〜4）
  - generate-data-json.js: financials.json + stock-prices.json → data.json 統合
  - docs/nvidia/data.json: 20四半期分の統合データ生成
  - docs/js/chart-builder.js: 4種類のグラフ描画ロジック
  - docs/css/style.css, docs/index.html, docs/nvidia/index.html
- [x] 最新決算サマリーをダッシュボード先頭に追加（KPIグリッド + 分析テキスト）
- [x] NVIDIA業績分析の充実化（4→10チャート、→ companies/nvidia/PLAN.md）
  - Phase 1: セグメント別売上（extract-segments.js → segments.json、チャート×2）
    - Data Center / Gaming / Professional Visualization / Automotive / OEM & Other
    - 19四半期分抽出、OEMは総売上との差分で算出、全四半期一致確認済み
  - Phase 2: B/S・キャッシュフロー（extract-balance-sheet.js / extract-cash-flows.js、チャート×2）
    - B/S: 8項目×19四半期（Cash, Total Assets/Liabilities/Equity, Debt等）
    - CF: 4項目×19四半期（Operating/Investing/Financing CF + FCF）
  - Phase 3: バリュエーション指標（PER / PSR / PBR 複合折れ線チャート×1）
    - sharesDilutedをスプリット調整してdata.jsonに統合
  - Phase 4: 成長率推移（売上高・営業利益・純利益のYoY成長率チャート×1）
- [x] 投資ポートフォリオの抽出・可視化（extract-investments.js → investments.json、チャート13）
- [x] 決算資料リンクセクションをダッシュボードに追加（ir-links.json、アコーディオンUI）
- [x] 財務データのHTML表+xlsxダウンロードをダッシュボードに追加
  - 全24項目（P/L・費用・利益・株式指標）をExcel準拠で表示
  - カテゴリ別背景色（売上:緑、利益:青、費用:橙、株式:紫）
  - 年度+四半期の2段ヘッダー、会社予想は「Q4予想」と明示
  - NVDA-Financials.xlsx ダウンロードリンク付き
- [x] 四半期ごとの分析ページ
  - TOP → NVIDIA → 期間選択 → 期間の分析ページ の4階層構成
  - ir-data → analysis にリネーム、quarters/YYYYQN/ フォルダ構成
  - generate-data-json.js で四半期別data.json + index.html を自動生成
  - 各四半期ページ: KPIサマリー + P/L詳細テーブル + ウォーターフォール + 13時系列チャート
  - NVIDIAトップをランディングページに簡素化（チャートは四半期ページへ移動）
- [x] 分析ページ復元: チャート分析コメント（1-1）+ 投資コミットメント（1-2）+ ワークフロー更新（1-4）
  - 全13チャートに「概要」+「分析」の2段構成を `<details class="chart-details">` 形式で復元
  - 投資コミットメントセクション（KPIグリッド + 主要コミットメント一覧）を追加
  - ワークフロー（analyze-and-visualize.md）にコンテンツ仕様・更新手順を追記済み
- [x] デザインブラッシュアップ
  - CSS変数でカラーパレットを一元管理（淡い緑+ピンク配色）
  - セクションナビゲーション（A〜E + 財務データ・決算資料）
  - A〜Eのセクショングループ見出し
  - チャート解説をdetails/summaryで折りたたみ化
  - レスポンシブ対応（768px/480pxブレークポイント）
- [x] Phase 2完了: 全28四半期の分析テキストを追加
  - FY2020-FY2021プレスリリース取得（8四半期分）
  - 全27四半期分のデータ抽出・data.json再生成
  - analysis-text.json: overviews（12チャート概要）+ 28四半期分の解説テキスト（サマリー+チャート別分析）
  - データ充足チェック手順をworkflowに追加（analyze-and-visualize.md）
- [x] 四半期ナビの前後リンクを端ページで非表示にする
  - generate-data-json.jsで各ページにprevPage/nextPageを付与
  - quarter-detail.jsのrenderNavをデータ駆動に変更
- [x] ir-links.json 404エラー・決算資料セクション非表示を修正
  - generate-ir-links.jsを作成し、フルビルドのStep 6で自動生成するよう変更
  - full-build.mdのワークフローにgenerate-ir-links.jsを追加
- [x] 分析ページの末尾に使用した財務データへのリンクを追加
- [x] 分析ページにエクセルの内容（財務データ表）を表示
- [x] デザイン調整: ヘッダーフラット化・ライムグリーン配色・ピンクアクセント強化
  - quarter-detail.jsにrenderFinancialTable()を追加（旧ランディングページのコードを移植）
  - template.htmlに財務データセクション+セクションナビリンクを追加
  - 24行の財務項目（P/L・費用・利益率・株式指標）をカテゴリ別色分けで表示
- [x] ヘッダーにサイト名を表示
- [x] トップページ改善: 各企業カードに分析ページの生成済み期間を表示
- [x] トップページ改善: 各企業カードに次の決算発表日を表示（過ぎていたらアクセントカラーで強調）
  - config.json に nextEarningsDate を追加、generate-data-json.js で data.json に伝搬
  - index.html で各社の data.json を fetch し動的表示
- [x] Intel Corporation (INTC) のページを追加（フルビルド）
  - 決算資料DL: FY2020〜FY2025（24四半期分のpress-release + 10-Q/10-K）
  - データ抽出: financials, segments, balance-sheet, cash-flows, segment-profit, investments
  - xlsx生成・検証（216/216項目一致）
  - GitHub Pages: ランディングページ + 8四半期分の詳細ページ（2024Q1〜2025Q4）
  - analysis-text.json: 12チャート概要 + 8四半期分の決算サマリー・チャート解説
  - トップページにIntelカードを追加、chart-builder.jsにセグメントラベル追加
- [x] Tesla, Inc. (TSLA) のページを追加（フルビルド）
  - 決算資料DL: FY2020〜FY2025（24四半期分のpress-release + 10-Q/10-K）
  - データ抽出: financials, segments, balance-sheet, cash-flows, segment-profit, investments
  - Teslaのプレスリリースはスライド形式（画像+隠しテキスト）のため、FONT/p要素からのテキスト解析 + 10-Q/10-Kフォールバックの独自戦略を構築
  - xlsx生成・検証（536/536項目一致）
  - GitHub Pages: ランディングページ + 8四半期分の詳細ページ（2024Q1〜2025Q4）
  - analysis-text.json: 12チャート概要 + 8四半期分の決算サマリー・チャート解説
  - トップページにTeslaカードを追加
- [x] 四半期詳細ページの決算サマリーを改善（全7社・56四半期）
  - プレスリリースから定性情報（CEOコメント、主要トピックス、来期ガイダンス・展望）を抽出
  - analysis-text.jsonに`type: "qualitative"`項目として既存の数値分析テキストの前に追加
  - quarter-detail.jsに定性情報の描画ロジックを追加（左ボーダー付きブロック、箇条書き対応）
  - style.cssにsummary-block/summary-financialスタイルを追加
  - analyze-and-visualize.mdワークフローに新フォーマット仕様を追記
  - 対象企業: NVIDIA, Broadcom, Alphabet, Intel, Meta, Palantir, Tesla
- [x] Alphabet Inc. (GOOGL) のページを追加（フルビルド）
  - 決算資料DL: FY2020〜FY2025（24四半期分のpress-release + 10-Q/10-K）
  - データ抽出: financials, segments, balance-sheet, cash-flows, segment-profit, investments（6スクリプト）
  - 6セグメント売上（Google Search, YouTube Ads, Google Network, Subscriptions, Cloud, Other Bets）+ 3セグメント損益（Google Services, Cloud, Other Bets + Alphabet-level Activities）
  - xlsx生成・検証（264/264項目一致）
  - GitHub Pages: ランディングページ + 8四半期分の詳細ページ（2024Q1〜2025Q4）
  - analysis-text.json: 12チャート概要 + 8四半期分の決算サマリー・チャート解説
  - chart-builder.jsにAlphabetセグメントラベル追加、色パレット拡張
  - トップページにAlphabetカードを追加
- [x] Apple Inc. (AAPL) のページを追加（フルビルド）
  - 決算資料DL: FY2021〜FY2026（21四半期分のpress-release + 10-Q/10-K）
  - データ抽出: financials, segments, balance-sheet, cash-flows, segment-profit, investments（6スクリプト）
  - Apple固有対応: 累積キャッシュフロー→四半期変換、EU State Aid税金費用の影響注記
  - 地域5セグメント売上（Americas, Europe, Greater China, Japan, Rest of Asia Pacific）+ 製品5セグメント売上（iPhone, Mac, iPad, Wearables, Services）
  - xlsx生成・検証（189リテラル値 + 214数式セル 全一致）
  - GitHub Pages: ランディングページ + 8四半期分の詳細ページ（2024Q2〜2026Q1）
  - analysis-text.json: 12チャート概要 + 8四半期分の決算サマリー・チャート解説（定性情報含む）
  - トップページにAppleカードを追加
- [x] Microsoft Corporation (MSFT) のページを追加（フルビルド）
- [x] OGP（Open Graph）メタタグを追加し、外部サイトからのリンク時にタイトル・説明・画像等が表示されるようにする
- [x] トップページのデザインをWSJ風・ティッカー強調スタイルに刷新（np2-02ベース）
  - 企業カード型 → 新聞3カラムレイアウト
  - ティッカーシンボル黒バッジ強調、ホバー時に色あせた新聞色（#faf7ef）
  - マストヘッド（大タイトル・ダブルボーダー）＋リードセクション（キャラ画像）追加
  - 「全 9 社」セクションヘッダーを企業リスト上部に追加
- [x] 全企業トップページ（docs/<企業名>/index.html）のデザインをWSJ風スタイルに刷新
  - マストヘッド（ティッカーバッジ・大タイトル・ダブルボーダー）＋パンくずバー
  - 「四 半 期 分 析」セクションヘッダー・次の決算発表日表示
  - キャラクター画像（ai-craw-patterns-working）をマストヘッドに配置
  - 各社の generate-pages.js の generateLandingPage() も同様に更新（全9社）
- [x] 全四半期ページ（詳細・一覧）のデザインをWSJ風スタイルに刷新
  - 四半期選択ページ（quarters/index.html）: マストヘッド+パンくずバー+WSJ風カードレイアウト
  - 四半期詳細ページ（quarters/<YYYYQN>/index.html）: WSJ風ヘッダー+セクション構成
  - 全9社のgenerate-pages.jsを更新
- [x] 企業名を正式名称に統一（NVIDIA Corporation, Broadcom Inc., Meta Platforms, Inc., Palantir Technologies Inc., Microsoft Corporation）
  - docs/index.html, docs/<企業名>/index.html, quarters/index.html, quarters/template.html を修正
  - 各社generate-pages.jsのCOMPANY定数を正式名称に更新
  - フッターのデータソース表記も統一
- [x] Taiwan Semiconductor Manufacturing (TSM) のページを追加（フルビルド）
  - 決算資料DL: FY2020〜FY2025（24四半期分のpress-release + presentation、SEC EDGAR 6-K）
  - TSMC固有対応: 外国民間発行体（6-K filing）、TIFRS会計、NT$通貨、ADR EPS併記
  - データ抽出: financials（プレスリリースP/L表）, segments（プレゼンテーション隠しテキスト）, balance-sheet, cash-flows
  - B/S・CFはFY2023以降のみ取得可能（プレゼンテーション隠しテキスト形式）
  - セグメント: Revenue by Platform（HPC, Smartphone, IoT, Automotive, DCE, Others）
  - xlsx生成・検証（216/216項目一致）
  - GitHub Pages: ランディングページ + 8四半期分の詳細ページ（2024Q1〜2025Q4）
  - analysis-text.json: 9チャート概要 + 8四半期分の決算サマリー・チャート解説
  - トップページにTSMCカードを追加（9社→10社）
- [x] 決算更新ワークフローを作成（workflows/update-earnings.md）
  - 既存企業に新しい決算データが出た際の差分更新手順を定義
  - フルビルドとの違い: データ削除なし・スクリプト流用・新四半期のみDL
  - CLAUDE.mdにワークフロー参照を追加
- [x] NVIDIA (NVDA) FY2026 Q4 決算更新（決算更新ワークフロー初回実行）
  - 決算資料DL: FY2026 Q4 press-release.html（SEC EDGAR）+ 10-K.pdf（HTM→PDF変換）
  - データ抽出: 全6スクリプト再実行（24四半期分）
  - xlsx生成・検証: 216リテラル値 + 247数式セル = 全463項目一致
  - ページ生成: ランディング + 9四半期分の詳細ページ（2024Q4〜2026Q4）
  - analysis-text.json: 2026Q4の決算サマリー（定性3+数値4項目）+ 12チャート解説を追加
  - config.json: nextEarningsDate を 2026-05-28（FY2027 Q1）に更新
  - download-filings.js / download-10q-10k.js にFY2026 Q4エントリを追加
