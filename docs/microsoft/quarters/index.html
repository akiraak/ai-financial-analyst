<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Microsoft 四半期分析一覧</title>
  <meta property="og:title" content="Microsoft 四半期分析一覧">
  <meta property="og:description" content="Microsoftの四半期ごとの業績分析・チャートを閲覧">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://akiraak.github.io/ai-financial-analyst/microsoft/quarters/">
  <meta property="og:image" content="https://akiraak.github.io/ai-financial-analyst/ogp.png">
  <meta property="og:site_name" content="AI Financial Analyst">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="stylesheet" href="../../css/style.css">
  <style>
    /* ===== WSJ風スタイル上書き ===== */
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:Georgia,'Times New Roman',serif; background:#fff; color:#111; line-height:1.6; }
    .container { max-width:1100px; margin:0 auto; padding:0 20px; }

    /* パンくず */
    .qd-bc { padding:7px 0; border-bottom:1px solid #e0e0e0; }
    .qd-bc .inner { max-width:1100px; margin:0 auto; padding:0 20px; font-family:-apple-system,sans-serif; font-size:.72rem; color:#999; }
    .qd-bc a { color:#555; text-decoration:none; }
    .qd-bc a:hover { text-decoration:underline; }
    .qd-bc .sep { margin:0 6px; color:#ccc; }

    /* マストヘッド */
    .qd-mh { padding:20px 0 14px; border-bottom:3px double #111; }
    .qd-mh .inner { max-width:1100px; margin:0 auto; padding:0 20px; display:flex; align-items:center; justify-content:center; gap:24px; }
    .qd-mh .qd-mh-content { text-align:center; }
    .qd-mh .qd-hl { display:flex; align-items:baseline; justify-content:center; gap:12px; }
    .qd-mh h1 { font-size:2.6rem; font-weight:900; letter-spacing:-.04em; color:#111; line-height:1; }
    .qd-mh .tk { font-size:.85rem; font-family:-apple-system,sans-serif; font-weight:800; color:#fff; background:#222; padding:3px 9px; border-radius:3px; letter-spacing:.06em; line-height:1; transform:translateY(-5px); }
    .qd-mh .qd-sub { font-size:.85rem; font-family:-apple-system,sans-serif; color:#888; margin-top:8px; }
    .qd-mh .qd-char img { width:110px; }

    /* セクション */
    .section { background:#fff; border-radius:0; box-shadow:none; padding:18px 0; margin-bottom:0; border-bottom:1px solid #e8e8e8; }
    .section:last-child { border-bottom:none; }
    .section h2 { font-family:Georgia,'Times New Roman',serif; font-size:1.15rem; font-weight:700; color:#fff; background:#222; padding:8px 14px; margin:0 -14px 16px; border-bottom:none; }

    /* 四半期カード */
    .quarter-card-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:14px; margin-top:10px; }
    .quarter-card { display:block; background:#f7f7f7; border:1px solid #e0e0e0; border-radius:0; padding:16px; text-decoration:none; color:#111; transition:background .15s; }
    .quarter-card:hover { background:#eee; }
    .quarter-card.outlook { background:#fafafa; border-style:dashed; color:#888; }
    .quarter-card-label { font-family:-apple-system,sans-serif; font-size:.8rem; font-weight:700; color:#555; margin-bottom:6px; }
    .quarter-card-revenue { font-family:Georgia,serif; font-size:1.3rem; font-weight:700; color:#111; }
    .quarter-card-meta { font-family:-apple-system,sans-serif; font-size:.7rem; color:#888; margin-top:2px; }
    .quarter-card-detail { font-family:-apple-system,sans-serif; font-size:.72rem; color:#555; margin-top:6px; }
    .quarter-card-sub { font-family:-apple-system,sans-serif; font-size:.7rem; color:#aaa; }

    /* フッター */
    .footer { border-top:1px solid #ccc; font-family:-apple-system,sans-serif; color:#888; padding:14px 0; margin-top:20px; }
    .footer a { color:#555; text-decoration:none; }
    .footer a:hover { text-decoration:underline; }

    @media(max-width:768px) {
      .qd-mh h1 { font-size:1.9rem; }
      .quarter-card-grid { grid-template-columns:repeat(auto-fill,minmax(130px,1fr)); }
    }
  </style>
</head>
<body>

  <!-- パンくず -->
  <div class="qd-bc">
    <div class="inner">
      <a href="../../">AI Financial Analyst</a>
      <span class="sep">/</span>
      <a href="../">Microsoft</a>
      <span class="sep">/</span>
      <span>四半期一覧</span>
    </div>
  </div>

  <!-- マストヘッド -->
  <div class="qd-mh">
    <div class="inner">
      <div class="qd-mh-content">
        <div class="qd-hl">
          <span class="tk">MSFT</span>
          <h1>Microsoft</h1>
        </div>
        <div class="qd-sub">四半期分析一覧</div>
      </div>
      <div class="qd-char">
        <img src="../../character/ai-craw-patterns-thinking.png" alt="AI Craw">
      </div>
    </div>
  </div>

  <div class="container" style="margin-top:20px;">
    <div id="quarterList"></div>
  </div>

  <div class="footer">
    <div class="container">
      <p><a href="../">ダッシュボード</a> | <a href="https://github.com/akiraak/ai-financial-analyst">GitHub</a></p>
    </div>
  </div>

  <script>
    fetch('../data.json')
      .then(r => r.json())
      .then(data => {
        const container = document.getElementById('quarterList');
        const fyGroups = {};
        data.quarters.forEach(q => {
          if (!fyGroups[q.fy]) fyGroups[q.fy] = [];
          fyGroups[q.fy].push(q);
        });
        const sortedFYs = Object.keys(fyGroups).sort((a, b) => b - a);

        for (const fy of sortedFYs) {
          const section = document.createElement('div');
          section.className = 'section';
          const sorted = fyGroups[fy].sort((a, b) => b.q - a.q);

          let html = '<h2>FY' + fy + '</h2><div class="quarter-card-grid">';
          for (const q of sorted) {
            const dirName = q.fy + 'Q' + q.q;
            if (q.isOutlook) {
              html += '<div class="quarter-card outlook">' +
                '<div class="quarter-card-label">Q' + q.q + '</div>' +
                '<div class="quarter-card-sub">ガイダンス</div>' +
                '<div class="quarter-card-revenue">' + (q.revenue ? '$' + (q.revenue / 1000).toFixed(1) + 'B' : '---') + '</div>' +
                '<div class="quarter-card-meta">売上（予想）</div>' +
                '</div>';
            } else {
              const margin = q.revenue ? (q.operatingIncome / q.revenue * 100).toFixed(1) : '---';
              html += '<a href="' + dirName + '/" class="quarter-card">' +
                '<div class="quarter-card-label">Q' + q.q + '</div>' +
                '<div class="quarter-card-revenue">$' + (q.revenue / 1000).toFixed(1) + 'B</div>' +
                '<div class="quarter-card-meta">売上高</div>' +
                '<div class="quarter-card-detail">営業利益率 ' + margin + '%</div>' +
                '</a>';
            }
          }
          html += '</div>';
          section.innerHTML = html;
          container.appendChild(section);
        }
      });
  </script>
</body>
</html>